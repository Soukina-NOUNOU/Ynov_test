<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: validator.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: validator.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Validate a French postal code
 * @param {string} postalCode The postal code to validate.
 * @returns {Object|null} An error object if the postal code is invalid, or null if it is valid.
 */
export function validatePostalCode(postalCode) {
    // Check if postal code is a string
    if (typeof postalCode !== "string") {
      return {
        code: "INVALID_POSTAL_CODE",
        message: "Le code postal doit être composé de 5 chiffres, un tiret, puis 4 chiffres (ex: 12345-6789).",
      };
    }
    const regex = /^[0-9]{5}-[0-9]{4}$/;
    // Check if postal code is exactly 5 digits, a dash, then 4 digits
    if (!regex.test(postalCode)) {
      return {
        code: "INVALID_POSTAL_CODE",
        message: "Le code postal doit être composé de 5 chiffres, un tiret, puis 4 chiffres (ex: 12345-6789).",
      };
    }
    return null;
}

/**
 * Validate first name and last name
 * @param {string} name The name to validate.
 * @returns {Object|null} An error object if the first name or last name is invalid, or null if they are valid.
 */
export function validateIdentity(name) {
    if (typeof name !== "string" || name.trim().length === 0) {
      return {
        code: "INVALID_IDENTITY",
        message: "Le nom et prénom sont obligatoires et ne peuvent pas être vides.",
      };
    }

    // Check minimum length (2 characters)
    if (name.trim().length &lt; 2) {
      return {
        code: "INVALID_LENGTH",
        message: "Le prénom doit contenir au moins 2 caractères",
      };
    }

    // Simple XSS detection: check for common XSS attack vectors
    const lowerName = name.toLowerCase();
    if (lowerName.includes("&lt;script") || lowerName.includes("&lt;/script>") || /&lt;[^>]+>/.test(name)) {
        return {
            code: "XSS_DETECTED",
            message: "Le nom contient des caractères dangereux non autorisés.",
        };
    }

    //Allow letters, spaces, hyphens and apostrophes
    const regex = /^[A-Za-zÀ-ÖØ-öø-ÿ\s-']+$/;
    if (!regex.test(name)) {
      return {
        code: "INVALID_IDENTITY",
        message: "Le nom ne doit contenir que des lettres, espaces, tirets et apostrophes.",
      };
    }

    return null;
}

/**
 * Validate an email address
 * @param {string} email The email address to validate.
 * @returns {Object|null} An error object if the email address is invalid, or null if it is valid.
 */
export function validateEmail(email) {
    // Check if email is a string
    if (typeof email !== "string") {
      return {
        code: "INVALID_EMAIL",
        message: "L'email doit être une adresse email valide.",
      };
    }

    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    // Check if email is in a valid format
    if (!emailRegex.test(email)) {
      return {
        code: "INVALID_EMAIL",
        message: "Veuillez saisir une adresse email valide (test@test.com).",
      };
    }

    return null;
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#addUserToList">addUserToList</a></li><li><a href="global.html#calculateAge">calculateAge</a></li><li><a href="global.html#countUsers">countUsers</a></li><li><a href="global.html#filterUsers">filterUsers</a></li><li><a href="global.html#formatUserCountText">formatUserCountText</a></li><li><a href="global.html#loadUsersFromStorage">loadUsersFromStorage</a></li><li><a href="global.html#saveUsersToStorage">saveUsersToStorage</a></li><li><a href="global.html#sortUsersByName">sortUsersByName</a></li><li><a href="global.html#userExists">userExists</a></li><li><a href="global.html#validateEmail">validateEmail</a></li><li><a href="global.html#validateIdentity">validateIdentity</a></li><li><a href="global.html#validatePostalCode">validatePostalCode</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Fri Feb 20 2026 11:47:52 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
